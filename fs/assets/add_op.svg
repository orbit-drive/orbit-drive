<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="823" height="680" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Note over Run: Entry Point
Note over Watcher: Add Op detected
Watcher->VTree: Add(path)
VTree->VNode: NewVNode(path)
VTree->VNode: SaveSource()
VNode->IPFS: UploadFile(path)
IPFS->VNode: Source.SetSrc(filehash)
Note over VTree: PushToState(path, addOp)
VTree->Run: StateChanges
Note over Run: Parse to proto
Run->P2P: FSTree proto
P2P-->VTree: FSTree sync
Note over VTree: VTree diff]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="57.8125" y="20" width="48.796875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="67.8125" y="44.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="67.8125">Run</tspan></text></g><g class="actor"><rect x="57.8125" y="622" width="48.796875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="67.8125" y="646.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="67.8125">Run</tspan></text></g><line x1="82.2109375" x2="82.2109375" y1="58" y2="622" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="126.609375" y="20" width="87.203125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="136.609375" y="44.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="136.609375">Watcher</tspan></text></g><g class="actor"><rect x="126.609375" y="622" width="87.203125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="136.609375" y="646.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="136.609375">Watcher</tspan></text></g><line x1="170.2109375" x2="170.2109375" y1="58" y2="622" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="266.4296875" y="20" width="68" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="276.4296875" y="44.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="276.4296875">VTree</tspan></text></g><g class="actor"><rect x="266.4296875" y="622" width="68" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="276.4296875" y="646.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="276.4296875">VTree</tspan></text></g><line x1="300.4296875" x2="300.4296875" y1="58" y2="622" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="420.8515625" y="20" width="68" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="430.8515625" y="44.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="430.8515625">VNode</tspan></text></g><g class="actor"><rect x="420.8515625" y="622" width="68" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="430.8515625" y="646.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="430.8515625">VNode</tspan></text></g><line x1="454.8515625" x2="454.8515625" y1="58" y2="622" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="666.4765625" y="20" width="58.40625" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="676.4765625" y="44.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="676.4765625">IPFS</tspan></text></g><g class="actor"><rect x="666.4765625" y="622" width="58.40625" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="676.4765625" y="646.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="676.4765625">IPFS</tspan></text></g><line x1="695.6796875" x2="695.6796875" y1="58" y2="622" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="744.8828125" y="20" width="48.796875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="754.8828125" y="44.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="754.8828125">P2P</tspan></text></g><g class="actor"><rect x="744.8828125" y="622" width="48.796875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="754.8828125" y="646.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="754.8828125">P2P</tspan></text></g><line x1="769.28125" x2="769.28125" y1="58" y2="622" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="24.40625" y="78" width="115.609375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="29.40625" y="97.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="29.40625">Entry Point</tspan></text></g><g class="note"><rect x="93.203125" y="126" width="154.015625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="98.203125" y="145.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="98.203125">Add Op detected</tspan></text></g><g class="signal"><text x="192.1171875" y="184.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="192.1171875">Add(path)</tspan></text><line x1="170.2109375" x2="300.4296875" y1="192" y2="192" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="310.4296875" y="222.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="310.4296875">NewVNode(path)</tspan></text><line x1="300.4296875" x2="454.8515625" y1="230" y2="230" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="320.03125" y="260.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="320.03125">SaveSource()</tspan></text><line x1="300.4296875" x2="454.8515625" y1="268" y2="268" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="498.453125" y="298.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="498.453125">UploadFile(path)</tspan></text><line x1="454.8515625" x2="695.6796875" y1="306" y2="306" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="464.8515625" y="336.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="464.8515625">Source.SetSrc(filehash)</tspan></text><line x1="695.6796875" x2="454.8515625" y1="344" y2="344" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="180.2109375" y="364" width="240.4375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="185.2109375" y="383.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="185.2109375">PushToState(path, addOp)</tspan></text></g><g class="signal"><text x="133.7109375" y="422.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="133.7109375">StateChanges</tspan></text><line x1="300.4296875" x2="82.2109375" y1="430" y2="430" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="10" y="450" width="144.421875" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="469.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Parse to proto</tspan></text></g><g class="signal"><text x="368.13671875" y="508.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="368.13671875">FSTree proto</tspan></text><line x1="82.2109375" x2="769.28125" y1="516" y2="516" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="482.05078125" y="546.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="482.05078125">FSTree sync</tspan></text><line x1="769.28125" x2="300.4296875" y1="554" y2="554" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="247.421875" y="574" width="106.015625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="252.421875" y="593.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="252.421875">VTree diff</tspan></text></g></svg>